services:
  event_dispatcher:
    class: Symfony\Component\EventDispatcher\EventDispatcher
    public: true
  file_system:
    class: Symfony\Component\Filesystem\Filesystem
    public: true
  common_console_application:
    class: Symfony\Component\Console\Application
    public: true
    arguments: ['CommonConsole', '0.0.1']
  console.input:
    class: Symfony\Component\Console\Input\ArgvInput
    public: true
  console.output:
    class: Symfony\Component\Console\Output\ConsoleOutput
    factory: ['EclipseGc\CommonConsole\OutputFactory', 'createOutput']
    arguments: ['@event_dispatcher']
    public: true
  console.logger:
    class: Symfony\Component\Console\Logger\ConsoleLogger
    public: true
    arguments: ['@console.output']
  question.finder:
    class: EclipseGc\CommonConsole\QuestionFactory
    arguments: ['@service_container']
  process.runner:
    class: EclipseGc\CommonConsole\ProcessRunner
    arguments: ['@console.input']
  command.platform.create:
    class: EclipseGc\CommonConsole\Command\PlatformCreate
    arguments: ['@event_dispatcher', '@question.finder']
    tags:
      - { name: common_console_command }
  command.platform.sites:
    class: EclipseGc\CommonConsole\Command\PlatformSites
    public: true
    arguments: ['@event_dispatcher']
    tags:
      - { name: common_console_command }
  alias.finder:
    class: EclipseGc\CommonConsole\EventSubscriber\ConsoleCommand\AliasFinder
    arguments: ['@event_dispatcher']
    tags:
      - { name: kernel.event_subscriber }
  platform.bootstrapper:
    class: EclipseGc\CommonConsole\EventSubscriber\ConsoleCommand\Bootstrapper
    tags:
      - { name: kernel.event_subscriber }
  finder.default:
    class: EclipseGc\CommonConsole\EventSubscriber\FindAlias\DefaultFinder
    arguments: ['@file_system', '@event_dispatcher', '@process.runner', '@service_container']
    tags:
      - { name: kernel.event_subscriber }

  # Output formatting.
  formatting.output.default:
    class: EclipseGc\CommonConsole\EventSubscriber\OutputFormatterStyle\DefaultOutputFormatterStyle
    tags:
      - { name: kernel.event_subscriber }

  # Platform definitions.
  platform.ssh:
    class: EclipseGc\CommonConsole\EventSubscriber\Platform\PlatformSubscriberSsh
    tags:
      - { name: kernel.event_subscriber }

  # Platform Bootstraps
  bootstrap.drupal:
    class: EclipseGc\CommonConsole\EventSubscriber\Bootstrap\Drupal
    arguments: ['%autoloader%']
    tags:
      - { name: kernel.event_subscriber }

  # Add Platform to Command expectation validation
  validate.platform.any:
    class: EclipseGc\CommonConsole\EventSubscriber\AddPlatform\AnyPlatform
    tags:
      - { name: kernel.event_subscriber }
  validate.platform.id:
    class: EclipseGc\CommonConsole\EventSubscriber\AddPlatform\PlatformIdMatch
    tags:
      - { name: kernel.event_subscriber }
  validate.platform.instanceof:
    class: EclipseGc\CommonConsole\EventSubscriber\AddPlatform\PlatformIsInstanceOf
    tags:
      - { name: kernel.event_subscriber }
